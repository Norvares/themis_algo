import algos
import rethinkdb as r

c = r.connect()
preprocessing = [lemmatizer, stemmer, onlyNounsAndNames, NounsLemma, NounsStemmer, topten]
for pp in preprocessing:
    i = 0
    while (i < 10):
        cursor = r.db("themis").table("pages").limit(1000).run(c)
        jsonResult = algos.kmeans(cursor, 1000, 20, 250, 'k-means++', 10, 1000, 0.0001, 'auto', 0, None, True, 1, pp)
        r.db("themis").table("ppExperiment").insert(jsonResult).run(c)
        i = i+1
